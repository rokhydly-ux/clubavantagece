<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bonus Central Equipements</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-image: 
                linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)),
                url("https://www.groupesebi.com/wp-content/uploads/2020/04/cuisine-whole-sebi-paris-idf-normandie-1-uai-1600x685.jpg");
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }
        .gold-text {
            background: linear-gradient(135deg, #8B0000, #A0001C, #8B0000);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .shine {
            position: relative;
            overflow: hidden;
        }
        .shine::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shine 3s infinite;
        }
        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        /* Animation de la bo√Æte cadeau */
        .gift-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            animation: fadeOut 0.5s ease-in-out 2.5s forwards;
        }
        
        .gift-box {
            position: relative;
            width: 120px;
            height: 120px;
            perspective: 1000px;
        }
        
        .gift-base {
            width: 120px;
            height: 80px;
            background: linear-gradient(45deg, #dc2626, #b91c1c);
            border-radius: 8px;
            position: absolute;
            bottom: 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .gift-lid {
            width: 120px;
            height: 40px;
            background: linear-gradient(45deg, #dc2626, #b91c1c);
            border-radius: 8px 8px 4px 4px;
            position: absolute;
            top: 0;
            transform-origin: bottom;
            animation: openLid 1s ease-in-out 0.5s forwards;
        }
        
        .gift-ribbon-v {
            width: 8px;
            height: 120px;
            background: linear-gradient(to bottom, #fbbf24, #f59e0b);
            position: absolute;
            left: 56px;
            top: 0;
            border-radius: 4px;
        }
        
        .gift-ribbon-h {
            width: 120px;
            height: 8px;
            background: linear-gradient(to right, #fbbf24, #f59e0b);
            position: absolute;
            left: 0;
            top: 36px;
            border-radius: 4px;
        }
        
        .gift-bow {
            width: 24px;
            height: 16px;
            background: #fbbf24;
            position: absolute;
            left: 48px;
            top: 28px;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            transform: rotate(45deg);
        }
        
        .gift-bow::before {
            content: '';
            width: 24px;
            height: 16px;
            background: #fbbf24;
            position: absolute;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            transform: rotate(90deg);
        }
        
        .percentage-popup {
            position: absolute;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 48px;
            font-weight: 900;
            color: #fbbf24;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            opacity: 0;
            animation: popOut 1.5s ease-out 1.2s forwards;
        }
        
        .particles {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #fbbf24;
            border-radius: 50%;
            opacity: 0;
            animation: sparkle 2s ease-out forwards;
        }
        
        @keyframes openLid {
            0% { transform: rotateX(0deg); }
            100% { transform: rotateX(-120deg); }
        }
        
        @keyframes popOut {
            0% { 
                opacity: 0; 
                transform: translateX(-50%) scale(0.5) translateY(20px); 
            }
            50% { 
                opacity: 1; 
                transform: translateX(-50%) scale(1.2) translateY(-10px); 
            }
            100% { 
                opacity: 1; 
                transform: translateX(-50%) scale(1) translateY(-20px); 
            }
        }
        
        @keyframes sparkle {
            0% { 
                opacity: 1; 
                transform: scale(0) rotate(0deg); 
            }
            50% { 
                opacity: 1; 
                transform: scale(1) rotate(180deg); 
            }
            100% { 
                opacity: 0; 
                transform: scale(0.5) rotate(360deg) translateY(-100px); 
            }
        }
        
        @keyframes fadeOut {
            0% { opacity: 1; }
            100% { opacity: 0; visibility: hidden; }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
    <!-- Animation de la bo√Æte cadeau -->
    <div id="gift-animation" class="gift-animation">
        <div class="gift-box">
            <div class="gift-base"></div>
            <div class="gift-lid"></div>
            <div class="gift-ribbon-v"></div>
            <div class="gift-ribbon-h"></div>
            <div class="gift-bow"></div>
            <div class="percentage-popup">-5%</div>
            <div class="particles" id="particles"></div>
        </div>
    </div>
    <!-- Header avec logo -->
    <header class="bg-white shadow-sm p-4 text-center">
        <div class="flex items-center justify-center">
            <img src="https://drive.google.com/uc?export=view&id=16BNfLhxK9tQKcMqOGpT_huLM9QzO129f" 
                 alt="Central Equipements" 
                 class="h-12 w-auto object-contain"
                 onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
            <h1 class="text-xl font-bold hidden" style="color: #22a8dc;">CENTRAL EQUIPEMENTS</h1>
        </div>
    </header>

    <!-- Contenu principal -->
    <main class="flex-1 px-6 py-8 space-y-8">
        <!-- Section Titre -->
        <div class="text-center space-y-4">
            <div class="flex items-center justify-center space-x-3">
                <svg class="w-8 h-8 text-yellow-500 pulse-animation" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
                <h2 class="text-3xl font-black tracking-wide" style="color: #22a8dc;">BONUS ACTIV√â !</h2>
                <svg class="w-8 h-8 text-red-500 pulse-animation" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M20 6h-2.18c.11-.31.18-.65.18-1a2.996 2.996 0 0 0-5.5-1.65l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1z"/>
                </svg>
            </div>
        </div>

        <!-- Section Gain -->
        <div class="bg-white rounded-2xl shadow-lg p-8 text-center shine">
            <div class="space-y-2">
                <div class="text-7xl font-black gold-text pulse-animation">-5%</div>
                <div class="text-2xl font-bold text-gray-700 tracking-widest">SUPPL√âMENTAIRES</div>
            </div>
        </div>

        <!-- Section Code S√©curis√© -->
        <div class="bg-gray-300 rounded-2xl shadow-lg p-6 text-gray-800">
            <div class="space-y-4">
                <div class="flex items-center justify-center space-x-2">
                    <svg class="w-6 h-6 text-gray-600" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 1L3 5v6c0 5.55 3.84 9.74 9 11 5.16-1.26 9-5.45 9-11V5l-9-4z"/>
                        <path d="M9 12l2 2 4-4" stroke="white" stroke-width="2" fill="none"/>
                    </svg>
                    <p class="text-lg font-semibold text-gray-700">CODE S√âCURIS√â DE VALIDATION</p>
                </div>
                
                <!-- Formulaire de validation -->
                <div id="validation-form" class="space-y-4">
                    <div class="bg-white rounded-xl p-4 space-y-3 border border-gray-200">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div class="text-left">
                                <label class="block text-sm font-medium mb-1 text-gray-700">Nom * :</label>
                                <input type="text" id="lastname-input" class="w-full px-3 py-2 rounded-lg border border-gray-300 text-gray-800 font-medium" placeholder="Votre nom" required>
                            </div>
                            <div class="text-left">
                                <label class="block text-sm font-medium mb-1 text-gray-700">Pr√©nom * :</label>
                                <input type="text" id="firstname-input" class="w-full px-3 py-2 rounded-lg border border-gray-300 text-gray-800 font-medium" placeholder="Votre pr√©nom" required>
                            </div>
                        </div>
                        
                        <div class="text-left">
                            <label class="block text-sm font-medium mb-1 text-gray-700">T√©l√©phone :</label>
                            <input type="tel" id="phone-input" class="w-full px-3 py-2 rounded-lg border border-gray-300 text-gray-800 font-medium" placeholder="Ex: 06 12 34 56 78">
                        </div>
                        
                        <div class="text-center text-sm font-medium text-gray-600">
                            OU
                        </div>
                        
                        <div class="text-left">
                            <label class="block text-sm font-medium mb-1 text-gray-700">Email :</label>
                            <input type="email" id="email-input" class="w-full px-3 py-2 rounded-lg border border-gray-300 text-gray-800 font-medium" placeholder="votre@email.com">
                        </div>
                        
                        <div class="text-left">
                            <label class="block text-sm font-medium mb-1 text-gray-700">Num√©ro de facture (4 chiffres) * :</label>
                            <input type="text" id="invoice-input" maxlength="4" class="w-full px-3 py-2 rounded-lg border border-gray-300 text-gray-800 font-medium text-center text-xl tracking-widest" placeholder="0000" required>
                        </div>
                        
                        <div class="text-xs text-gray-600 bg-gray-50 p-2 rounded">
                            * Champs obligatoires. Vous devez renseigner soit votre t√©l√©phone, soit votre email.
                        </div>
                        
                        <button onclick="validateAndGenerateCode()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                            üîì G√âN√âRER MON CODE
                        </button>
                    </div>
                </div>

                <!-- Code g√©n√©r√© (cach√© initialement) -->
                <div id="code-display" class="hidden space-y-4">
                    <div class="bg-white rounded-xl p-4 text-center border-2 border-green-500">
                        <div class="text-4xl font-black tracking-widest" style="color: #22a8dc;" id="unique-code">
                            CE000
                        </div>
                    </div>
                    <div class="text-sm text-gray-600 space-y-1 bg-white p-3 rounded-lg">
                        <p>üîí <strong>Code unique et non r√©utilisable</strong></p>
                        <p>‚è∞ Valide 24h pour vos informations</p>
                        <p>üë§ Client: <span id="validated-client" class="font-semibold"></span></p>
                        <p>üìû Contact: <span id="validated-contact" class="font-semibold"></span></p>
                    </div>
                    <div class="bg-red-100 border border-red-300 rounded-lg p-3">
                        <p class="text-red-700 text-sm font-medium">
                            ‚ö†Ô∏è Vous ne pourrez plus g√©n√©rer de nouveau code avec ces informations.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section Validation (CRITIQUE) -->
        <div class="rounded-2xl shadow-lg p-6 text-center text-white" style="background-color: #22a8dc;">
            <div class="space-y-4">
                <p class="text-lg font-semibold">Valable uniquement le :</p>
                <div class="bg-white rounded-xl p-4 font-bold text-lg" style="color: #22a8dc;" id="current-datetime">
                    Chargement...
                </div>
                <div class="text-sm opacity-90">
                    ‚è∞ Mise √† jour en temps r√©el
                </div>
            </div>
        </div>

        <!-- Section Action -->
        <div class="bg-gradient-to-r from-green-500 to-green-600 rounded-2xl shadow-lg p-6 text-center text-white">
            <div class="space-y-3">
                <svg class="w-12 h-12 mx-auto text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                </svg>
                <p class="text-lg font-semibold leading-relaxed">
                    Montrez cet √©cran √† votre conseiller pour profiter de votre remise imm√©diate.
                </p>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-black text-white py-8 px-6">
        <div class="max-w-6xl mx-auto">
            <!-- Ligne d'information sur l'offre -->
            <div class="text-center mb-8 pb-6 border-b border-gray-700">
                <p class="text-sm text-gray-300">
                    Offre personnelle, valable une fois par jour sur pr√©sentation de cet √©cran.
                </p>
            </div>
            
            <!-- Contenu principal du footer -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Section 1: Coordonn√©es -->
                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-white mb-4">Nos Coordonn√©es</h3>
                    
                    <!-- Adresse -->
                    <div class="flex items-start space-x-3">
                        <svg class="w-5 h-5 text-blue-400 mt-1 flex-shrink-0" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                        </svg>
                        <div>
                            <a href="https://maps.google.com/?q=Central+Equipements+Keur+Massar+en+Face+du+Supermarch√©+Auchan" 
                               target="_blank" 
                               class="text-white font-medium hover:text-blue-400 transition-colors">
                                Central Equipements
                            </a>
                            <p class="text-gray-300 text-sm">Keur Massar en Face du Supermarch√© Auchan</p>
                        </div>
                    </div>
                    
                    <!-- T√©l√©phone -->
                    <div class="flex items-center space-x-3">
                        <svg class="w-5 h-5 text-green-400 flex-shrink-0" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893A11.821 11.821 0 0020.465 3.516"/>
                        </svg>
                        <a href="https://wa.me/221762237440?text=J%27ai%20visit%C3%A9%20votre%20site%20Central%20Equipements%20et%20j%27aimerais%20plus%20d%27informations%20sur%20vos%20produits" 
                           target="_blank" 
                           class="text-white font-medium hover:text-green-400 transition-colors">
                            762237440
                        </a>
                    </div>
                    
                    <!-- Email -->
                    <div class="flex items-center space-x-3">
                        <svg class="w-5 h-5 text-red-400 flex-shrink-0" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.89 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                        </svg>
                        <a href="mailto:contact@centralequipements.com" 
                           class="text-white font-medium hover:text-red-400 transition-colors">
                            contact@centralequipements.com
                        </a>
                    </div>
                </div>
                
                <!-- Section 2: Liens utiles -->
                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-white mb-4">Liens Utiles</h3>
                    <div class="space-y-3">
                        <a href="https://www.centralequipements.com" target="_blank" class="flex items-center space-x-2 text-gray-300 hover:text-white transition-colors group">
                            <svg class="w-4 h-4 text-gray-400 group-hover:text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
                            </svg>
                            <span>Mentions L√©gales</span>
                        </a>
                        
                        <a href="https://www.centralequipements.com" target="_blank" class="flex items-center space-x-2 text-gray-300 hover:text-white transition-colors group">
                            <svg class="w-4 h-4 text-gray-400 group-hover:text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                            </svg>
                            <span>Service Apr√®s-Vente</span>
                        </a>
                        
                        <a href="https://www.centralequipements.com" target="_blank" class="flex items-center space-x-2 text-gray-300 hover:text-white transition-colors group">
                            <svg class="w-4 h-4 text-gray-400 group-hover:text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                            </svg>
                            <span>Qui Sommes-Nous</span>
                        </a>
                    </div>
                </div>
                
                <!-- Section 3: Informations entreprise -->
                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-white mb-4">Central Equipements</h3>
                    <div class="space-y-3">
                        <a href="https://wa.me/221762237440?text=J%27ai%20visit%C3%A9%20votre%20site%20Central%20Equipements%20et%20j%27aimerais%20plus%20d%27informations%20sur%20vos%20%C3%A9quipements%20professionnels" 
                           target="_blank" 
                           class="flex items-center space-x-2 text-gray-300 hover:text-green-400 transition-colors group">
                            <svg class="w-4 h-4 text-yellow-400 group-hover:text-green-400" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                            </svg>
                            <span class="text-sm">√âquipements professionnels</span>
                        </a>
                        
                        <a href="https://wa.me/221762237440?text=J%27ai%20visit%C3%A9%20votre%20site%20Central%20Equipements%20et%20j%27aimerais%20plus%20d%27informations%20sur%20votre%20garantie%20qualit%C3%A9" 
                           target="_blank" 
                           class="flex items-center space-x-2 text-gray-300 hover:text-green-400 transition-colors group">
                            <svg class="w-4 h-4 text-blue-400 group-hover:text-green-400" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                            </svg>
                            <span class="text-sm">Qualit√© garantie</span>
                        </a>
                        
                        <a href="https://wa.me/221762237440?text=J%27ai%20visit%C3%A9%20votre%20site%20Central%20Equipements%20et%20j%27aimerais%20plus%20d%27informations%20sur%20vos%20services%20rapides" 
                           target="_blank" 
                           class="flex items-center space-x-2 text-gray-300 hover:text-green-400 transition-colors group">
                            <svg class="w-4 h-4 text-green-400" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/>
                            </svg>
                            <span class="text-sm">Service rapide</span>
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- Ligne de s√©paration et copyright -->
            <div class="border-t border-gray-700 mt-8 pt-6 text-center">
                <p class="text-gray-400 text-sm">
                    ¬© 2024 Central Equipements. Tous droits r√©serv√©s.
                </p>
            </div>
        </div>
    </footer>

    <script>
        // Syst√®me de stockage s√©curis√© (simulation)
        const securityStorage = {
            codes: JSON.parse(localStorage.getItem('ce_codes') || '{}'),
            
            saveCode: function(clientData, code) {
                const key = this.generateKey(clientData);
                this.codes[key] = {
                    code: code,
                    timestamp: Date.now(),
                    clientData: clientData
                };
                localStorage.setItem('ce_codes', JSON.stringify(this.codes));
            },
            
            getCode: function(clientData) {
                const key = this.generateKey(clientData);
                const stored = this.codes[key];
                
                if (!stored) return null;
                
                // V√©rifier si le code est encore valide (24h)
                const now = Date.now();
                const twentyFourHours = 24 * 60 * 60 * 1000;
                
                if (now - stored.timestamp > twentyFourHours) {
                    delete this.codes[key];
                    localStorage.setItem('ce_codes', JSON.stringify(this.codes));
                    return null;
                }
                
                return stored;
            },
            
            generateKey: function(clientData) {
                // Cr√©er une cl√© unique bas√©e sur les donn√©es client
                const contact = clientData.phone || clientData.email;
                return `${clientData.lastname}_${clientData.firstname}_${contact}_${clientData.invoice}`.toLowerCase();
            }
        };

        function generateCECode() {
            // G√©n√©rer un code au format CE + 3 chiffres
            const randomNum = Math.floor(Math.random() * 900) + 100; // 100-999
            return `CE${randomNum}`;
        }

        function validateAndGenerateCode() {
            const lastname = document.getElementById('lastname-input').value.trim();
            const firstname = document.getElementById('firstname-input').value.trim();
            const phone = document.getElementById('phone-input').value.trim();
            const email = document.getElementById('email-input').value.trim();
            const invoice = document.getElementById('invoice-input').value.trim();
            
            // Validation des champs obligatoires
            if (!lastname || !firstname || !invoice) {
                alert('Veuillez remplir tous les champs obligatoires (nom, pr√©nom, num√©ro de facture).');
                return;
            }
            
            // Validation du contact (t√©l√©phone OU email)
            if (!phone && !email) {
                alert('Veuillez renseigner soit votre num√©ro de t√©l√©phone, soit votre adresse email.');
                return;
            }
            
            // Validation de l'email si renseign√©
            if (email && (!email.includes('@') || !email.includes('.'))) {
                alert('Veuillez saisir une adresse email valide.');
                return;
            }
            
            // Validation du num√©ro de facture (exactement 4 chiffres)
            if (!/^\d{4}$/.test(invoice)) {
                alert('Le num√©ro de facture doit contenir exactement 4 chiffres.');
                return;
            }
            
            // Validation du t√©l√©phone si renseign√© (format fran√ßais basique)
            if (phone && !/^[0-9\s\-\+\.]{10,}$/.test(phone)) {
                alert('Veuillez saisir un num√©ro de t√©l√©phone valide.');
                return;
            }
            
            const clientData = {
                lastname: lastname,
                firstname: firstname,
                phone: phone,
                email: email,
                invoice: invoice
            };
            
            // V√©rifier si un code existe d√©j√† pour ce client
            let existingCode = securityStorage.getCode(clientData);
            
            let code;
            if (existingCode) {
                code = existingCode.code;
            } else {
                // G√©n√©rer un nouveau code
                code = generateCECode();
                securityStorage.saveCode(clientData, code);
            }
            
            // Afficher le code
            document.getElementById('unique-code').textContent = code;
            document.getElementById('validated-client').textContent = `${firstname} ${lastname}`;
            document.getElementById('validated-contact').textContent = phone || email;
            
            // Masquer le formulaire et afficher le code
            document.getElementById('validation-form').classList.add('hidden');
            document.getElementById('code-display').classList.remove('hidden');
            
            // Animation de succ√®s
            document.getElementById('code-display').style.animation = 'pulse 0.5s ease-in-out';
        }

        function updateDateTime() {
            const now = new Date();
            const options = {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            };
            
            const formattedDate = now.toLocaleDateString('fr-FR', options);
            document.getElementById('current-datetime').textContent = formattedDate;
        }

        // Animation des particules
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 12;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                // Position al√©atoire autour de la bo√Æte
                const angle = (360 / particleCount) * i;
                const radius = 60;
                const x = Math.cos(angle * Math.PI / 180) * radius + 60;
                const y = Math.sin(angle * Math.PI / 180) * radius + 60;
                
                particle.style.left = x + 'px';
                particle.style.top = y + 'px';
                particle.style.animationDelay = (1.2 + Math.random() * 0.5) + 's';
                
                particlesContainer.appendChild(particle);
            }
        }

        // V√©rifier au chargement si un code existe d√©j√†
        window.onload = function() {
            updateDateTime();
            
            // Cr√©er les particules pour l'animation
            createParticles();
            
            // Nettoyer les codes expir√©s au chargement
            const now = Date.now();
            const twentyFourHours = 24 * 60 * 60 * 1000;
            let codes = JSON.parse(localStorage.getItem('ce_codes') || '{}');
            let hasExpired = false;
            
            for (let key in codes) {
                if (now - codes[key].timestamp > twentyFourHours) {
                    delete codes[key];
                    hasExpired = true;
                }
            }
            
            if (hasExpired) {
                localStorage.setItem('ce_codes', JSON.stringify(codes));
            }
            
            // V√©rifier si l'utilisateur a d√©j√† un code valide
            checkExistingCode();
        };
        
        function checkExistingCode() {
            // Cette fonction pourrait √™tre √©tendue pour v√©rifier automatiquement
            // si l'utilisateur revient avec les m√™mes donn√©es
            // Pour l'instant, on laisse l'utilisateur saisir ses informations
        }
        
        // Mettre √† jour chaque seconde pour emp√™cher les captures d'√©cran
        setInterval(updateDateTime, 1000);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97644f03b3466e2d',t:'MTc1NjM4OTM1MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
